<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProNews - Live News</title>
    
    <style>
        /* --- 1. Global Setup & Variables --- */
        @import url('https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Oswald:wght@500;700&display=swap');

        :root {
            --font-heading: 'Oswald', sans-serif;
            --font-body: 'Lato', sans-serif;
            --color-primary: #00579c;
            --color-dark: #222;
            --color-body-text: #333;
            --color-muted-text: #777;
            --color-bg: #ffffff;
            --color-border: #eaeaea;
        }

        /* Universal reset */
        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: var(--font-body);
            background-color: var(--color-bg);
            color: var(--color-body-text);
            line-height: 1.7;
        }

        img { max-width: 100%; height: auto; display: block; }
        a { text-decoration: none; color: var(--color-primary); transition: color 0.3s ease; }
        a:hover { color: var(--color-dark); }
        h1, h2, h3, h4 {
            font-family: var(--font-heading);
            color: var(--color-dark);
            line-height: 1.3;
        }

        /* --- 2. Header & Navigation --- */
        .top-bar {
            background-color: var(--color-primary);
            color: var(--color-bg);
            padding: 0.5rem 0;
            font-size: 0.85rem;
        }
        .top-bar .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .main-header {
            background-color: var(--color-bg);
            border-bottom: 1px solid var(--color-border);
            padding: 1.5rem 0;
        }
        .main-header .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .site-title {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--color-dark);
            text-transform: uppercase;
        }
        .site-title a { color: var(--color-dark); }
        .main-nav ul { list-style: none; display: flex; gap: 2rem; }
        .main-nav a {
            color: var(--color-dark);
            font-weight: 700;
            font-size: 0.95rem;
            text-transform: uppercase;
            padding-bottom: 4px;
            border-bottom: 3px solid transparent;
            transition: color 0.3s ease, border-color 0.3s ease;
            cursor: pointer;
        }
        .main-nav a:hover { color: var(--color-primary); }
        .main-nav a.active {
            color: var(--color-primary);
            border-bottom-color: var(--color-primary);
        }

        /* --- 3. Main Content & Layout --- */
        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 0 1.5rem;
        }
        .page-container {
            display: flex;
            gap: 2.5rem;
            margin-top: 2.5rem;
        }
        .main-content {
            flex: 3;
            min-height: 500px; /* So the loader is centered */
        }
        .sidebar {
            flex: 1;
            border-left: 1px solid var(--color-border);
            padding-left: 2.5rem;
        }

        /* --- 4. Homepage Hero Grid --- */
        .hero-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }
        .hero-main { grid-column: 1 / 3; }
        .hero-main .article-card { border: none; }
        .hero-main .article-card img { height: 400px; object-fit: cover; }
        .hero-main .article-card h3 { font-size: 2.5rem; margin-top: 1rem; }
        .hero-main .article-card .article-excerpt {
            font-size: 1.1rem;
            color: var(--color-muted-text);
        }
        .hero-secondary .article-card { border: none; }
        .hero-secondary .article-card h3 { font-size: 1.4rem; }

        /* --- 5. Standard Article List (For categories) --- */
        .page-heading {
            font-family: var(--font-heading);
            font-size: 2rem;
            border-bottom: 3px solid var(--color-dark);
            padding-bottom: 0.5rem;
            margin-bottom: 2rem;
            text-transform: capitalize;
        }
        .article-list .article-card {
            display: flex;
            gap: 1.5rem;
        }
        .article-list .article-card img {
            width: 250px;
            height: 160px;
            object-fit: cover;
            flex-shrink: 0;
        }

        /* --- 6. Article Card --- */
        .article-card {
            background-color: var(--color-bg);
            border-bottom: 1px solid var(--color-border);
            padding-bottom: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .article-card img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            margin-bottom: 1rem;
        }
        .article-category {
            font-family: var(--font-body);
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--color-primary);
            text-transform: uppercase;
        }
        .article-content h3 {
            font-size: 1.5rem;
            margin: 0.25rem 0 0.5rem 0;
        }
        .article-content h3 a { color: var(--color-dark); }
        .article-content h3 a:hover { color: var(--color-primary); }
        .article-meta {
            font-size: 0.85rem;
            color: var(--color-muted-text);
            margin-bottom: 0.5rem;
        }
        .article-excerpt { font-size: 0.95rem; }

        /* --- 7. Sidebar Widget --- */
        .widget { margin-bottom: 2.5rem; }
        .widget-title {
            font-size: 1.4rem;
            text-transform: uppercase;
            border-bottom: 2px solid var(--color-dark);
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
        }
        .widget-post-list .widget-post {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        .widget-post img { width: 80px; height: 80px; object-fit: cover; }
        .widget-post h4 {
            font-family: var(--font-heading);
            font-size: 1rem;
            line-height: 1.4;
        }
        .widget-post h4 a { color: var(--color-dark); }

        .widget-link-list {
            list-style: none; /* Removes bullets */
        }
        .widget-link-list li {
            margin-bottom: 0.75rem;
        }
        .widget-link-list a {
            font-family: var(--font-body);
            font-weight: 700;
            color: var(--color-primary);
        }
        .widget-link-list a:hover {
            color: var(--color-dark);
        }

        .category-widget {
            display: none; /* Hide by default */
        }


        /* --- 8. Footer --- */
        .site-footer {
            background-color: var(--color-dark);
            color: #aaa;
            text-align: center;
            padding: 3rem 0;
            margin-top: 3rem;
            font-size: 0.9rem;
        }

        /* --- 9. Loader & Error (NEW) --- */
        .loader {
            width: 50px;
            height: 50px;
            border: 5px solid var(--color-border);
            border-top-color: var(--color-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 100px auto;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .error-message {
            font-size: 1.1rem;
            color: #d9534f;
            text-align: center;
            padding: 2rem;
            border: 1px solid #d9534f;
            background-color: #f2dede;
            border-radius: 4px;
        }


        /* --- 10. Responsive Design --- */
        @media (max-width: 900px) {
            .page-container { flex-direction: column; }
            .sidebar { border-left: none; padding-left: 0; border-top: 1px solid var(--color-border); padding-top: 2rem; }
        }
        @media (max-width: 768px) {
            .main-header .container { flex-direction: column; gap: 1.5rem; }
            .main-nav ul { flex-wrap: wrap; justify-content: center; gap: 1.5rem; }
            .article-list .article-card { flex-direction: column; }
            .article-list .article-card img { width: 100%; height: 200px; }
        }
        @media (max-width: 600px) {
            .hero-grid { grid-template-columns: 1fr; }
            .hero-main .article-card h3 { font-size: 2rem; }
        }
    </style>
</head>
<body>
    
    <header class="site-header">
        <div class="top-bar">
            <div class="container">
                <span id="current-date">October 27, 2025</span>
                <span>Follow us: X / Facebook</span>
            </div>
        </div>
        <div class="main-header">
            <div class="container">
                <h1 class="site-title"><a href="#">ProNews</a></h1>
                <nav class="main-nav">
                    <ul>
                        <li><a href="#" class="active" data-category="home">Home</a></li>
                        <li><a href="#" data-category="world">World</a></li>
                        <li><a href="#" data-category="technology">Technology</a></li>
                        <li><a href="#" data-category="business">Business</a></li>
                        <li><a href="#" data-category="sports">Sports</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <div class="page-container container">
        
        <main class="main-content">
            </main>
        
        <aside class="sidebar">
            <div class="widget" id="widget-top-stories">
                <h4 class="widget-title">Top Stories</h4>
                <div class="widget-post-list">
                    </div>
            </div>

            <div class="widget category-widget" id="widget-world">
                <h4 class="widget-title">World News</h4>
                <ul class="widget-link-list">
                    <li><a href="https://www.bbc.com/news/world" target="_blank">BBC World News</a></li>
                    <li><a href="https://edition.cnn.com/" target="_blank">CNN International</a></li>
                    <li><a href="https://www.reuters.com/" target="_blank">Reuters</a></li>
                    <li><a href="https://www.aljazeera.com/" target="_blank">Al Jazeera</a></li>
                    <li><a href="https://apnews.com/" target="_blank">Associated Press (AP)</a></li>
                    <li><a href="https://www.theguardian.com/world" target="_blank">The Guardian</a></li>
                </ul>
            </div>

            <div class="widget category-widget" id="widget-business">
                <h4 class="widget-title">Business News</h4>
                <ul class="widget-link-list">
                    <li><a href="https://www.bloomberg.com/" target="_blank">Bloomberg</a></li>
                    <li><a href="https://www.wsj.com/" target="_blank">The Wall Street Journal</a></li>
                    <li><a href="https://www.ft.com/" target="_blank">Financial Times</a></li>
                    <li><a href="https://www.forbes.com/" target="_blank">Forbes</a></li>
                    <li><a href="https://www.cnbc.com/" target="_blank">CNBC</a></li>
                    <li><a href="https://www.marketwatch.com/" target="_blank">MarketWatch</a></li>
                </ul>
            </div>

            <div class="widget category-widget" id="widget-technology">
                <h4 class="widget-title">Tech News</h4>
                <ul class="widget-link-list">
                    <li><a href="https://techcrunch.com/" target="_blank">TechCrunch</a></li>
                    <li><a href="https://www.theverge.com/" target="_blank">The Verge</a></li>
                    <li><a href="https://www.wired.com/" target="_blank">Wired</a></li>
                    <li><a href="https://arstechnica.com/" target="_blank">Ars Technica</a></li>
                    <li><a href="https://www.cnet.com/tech/" target="_blank">CNET</a></li>
                    <li><a href="https://www.engadget.com/" target="_blank">Engadget</a></li>
                </ul>
            </div>

            <div class="widget category-widget" id="widget-sports">
                <h4 class="widget-title">Sports News</h4>
                <ul class="widget-link-list">
                    <li><a href="https://www.espn.com/" target="_blank">ESPN</a></li>
                    <li><a href="https://www.cbssports.com/" target="_blank">CBS Sports</a></li>
                    <li><a href="https://bleacherreport.com/" target="_blank">Bleacher Report</a></li>
                    <li><a href="https://theathletic.com/" target="_blank">The Athletic</a></li>
                    <li><a href="https://www.skysports.com/" target="_blank">Sky Sports</a></li>
                    <li><a href="https://sports.yahoo.com/" target="_blank">Yahoo Sports</a></li>
                </ul>
            </div>

        </aside>
        
    </div> 
    
    <footer class="site-footer">
        <p>&copy; 2025 ProNews. All Rights Reserved.</p>
    </footer>
    
    <script>
        // Wait for the HTML document to be fully loaded before running script
        document.addEventListener("DOMContentLoaded", () => {

            // --- 1. CONFIGURATION & SELECTORS ---
            
            // 
            // 
            //  !!!!!!!!!!  IMPORTANT  !!!!!!!!!!
            //  This API key is public and will be blocked.
            //  You MUST get your own free key from https://mediastack.com/
            //
            const API_KEY = 'b88608d103bec27e70a60c229e330467';
            
            // Note: Free plans must use http, not https
            const MEDIASTACK_API_URL = `http://api.mediastack.com/v1/news?access_key=${API_KEY}`;

            // Get references to the HTML elements
            const mainContent = document.querySelector('.main-content');
            const sidebarList = document.querySelector('#widget-top-stories .widget-post-list');
            const navLinks = document.querySelectorAll('.main-nav a');
            const siteTitle = document.querySelector('.site-title a');
            const dateElement = document.getElementById('current-date');
            const categoryWidgets = document.querySelectorAll('.category-widget');

            // Update the date on the page
            dateElement.textContent = new Date().toLocaleDateString('en-US', {
                year: 'numeric', month: 'long', day: 'numeric'
            });

            
            // --- 2. CORE FUNCTIONS (Fetching & Rendering) ---

            /**
             * Fetches news from the MediaStack API.
             * @param {string} query - The search term (e.g., "technology")
             * @param {number} [max=9] - The number of articles to fetch
             * @returns {Promise<Array|null>} A promise that resolves to an array of articles or null if an error occurs.
             */
            async function fetchNews(query, max = 9) {
                mainContent.innerHTML = '<div class="loader"></div>';
                
                try {
                    // MediaStack uses 'keywords' and 'limit'
                    const formattedQuery = encodeURIComponent(query);
                    // We search in English, sort by popularity
                    const response = await fetch(`${MEDIASTACK_API_URL}&keywords=${formattedQuery}&limit=${max}&languages=en&sort=popularity`);
                    
                    if (!response.ok) {
                        throw new Error(`API Error: ${response.status} ${response.statusText}`);
                    }
                    const data = await response.json();
                    
                    // MediaStack nests articles in a 'data' array
                    return data.data; 
                } catch (error) {
                    console.error("Error fetching news:", error);
                    mainContent.innerHTML = `<div class="error-message">Could not fetch news. This is often due to an invalid API key, exceeding the daily request limit, or an http/httpsError. Please check the console.</div>`;
                    return null;
                }
            }

            /**
             * Renders the homepage layout with a hero grid.
             * @param {Array} articles - An array of article objects.
             */
            function renderHomepage(articles) {
                if (!articles || articles.length < 3) {
                    mainContent.innerHTML = `<div class="error-message">Not enough articles to display the homepage. The API may be having issues or the query returned no results.</div>`;
                    return;
                }

                const heroArticle = articles[0];
                const secondaryArticle1 = articles[1];
                const secondaryArticle2 = articles[2];

                const html = `
                    <div class="hero-grid">
                        <div class="hero-main">
                            ${createArticleCard(heroArticle, 'hero')}
                        </div>
                        <div class="hero-secondary">
                            ${createArticleCard(secondaryArticle1, 'secondary')}
                        </div>
                        <div class="hero-secondary">
                            ${createArticleCard(secondaryArticle2, 'secondary')}
                        </div>
                    </div>
                `;
                mainContent.innerHTML = html;
            }

            /**
             * Renders a standard category page with a list of articles.
             * @param {Array} articles - An array of article objects.
             * @param {string} categoryName - The name of the category (e.g., "world")
             */
            function renderCategoryPage(articles, categoryName) {
                if (!articles || articles.length === 0) {
                    mainContent.innerHTML = `<h2 class="page-heading">${categoryName} News</h2><p>No articles found for this category.</p>`;
                    return;
                }

                const articlesHtml = articles
                    .map(article => createArticleCard(article, 'list'))
                    .join('');

                const html = `
                    <h2 class="page-heading">${categoryName} News</h2>
                    <div class="article-list">
                        ${articlesHtml}
                    </div>
                `;
                mainContent.innerHTML = html;
            }

            /**
             * Renders the sidebar with "Top Stories".
             */
            async function renderSidebar() {
                // MediaStack's 'general' category is good for top stories
                const articles = await fetchNews('general', 4);
                
                if (!articles || articles.length === 0) {
                    sidebarList.innerHTML = "<p>Could not load stories.</p>";
                    return;
                }

                // `article.title` and `article.url` are the same
                const html = articles.map(article => `
                    <div class="widget-post">
                        <img src="${article.image || 'https://via.placeholder.com/80'}" alt="Story image">
                        <div>
                            <h4><a href="${article.url}" target="_blank">${article.title}</a></h4>
                        </div>
                    </div>
                `).join('');
                
                sidebarList.innerHTML = html;
            }

            /**
             * A helper function to create article cards from MediaStack data.
             * @param {object} article - An article object.
             * @param {'hero'|'secondary'|'list'} type - The type of card to build.
             * @returns {string} The HTML string for the card.
             */
            function createArticleCard(article, type) {
                // MediaStack fields
                const imageUrl = article.image || 'https://via.placeholder.com/400x220?text=No+Image';
                const author = article.author || article.source || 'Unknown Source';
                const title = article.title;
                const description = article.description;
                const url = article.url;
                const category = article.category;
                const publishedAt = article.published_at;

                if (type === 'hero') {
                    return `
                        <article class="article-card">
                            <img src="${imageUrl}" alt="${title}">
                            <div class="article-content">
                                <span class="article-category">${category}</span>
                                <h3><a href="${url}" target="_blank">${title}</a></h3>
                                <span class="article-meta">By ${author} / ${new Date(publishedAt).toLocaleDateString()}</span>
                                <p class="article-excerpt">${description}</p>
                            </div>
                        </article>
                    `;
                }
                
                if (type === 'secondary') {
                    return `
                        <article class="article-card">
                            <img src="${imageUrl}" alt="${title}">
                            <div class="article-content">
                                <span class="article-category">${category}</span>
                                <h3><a href="${url}" target="_blank">${title}</a></h3>
                                <span class="article-meta">${new Date(publishedAt).toLocaleDateString()}</span>
                            </div>
                        </article>
                    `;
                }
                
                if (type === 'list') {
                    return `
                        <article class="article-card">
                            <img src="${imageUrl}" alt="${title}">
                            <div class="article-content">
                                <span class="article-category">${category}</span>
                                <h3><a href="${url}" target="_blank">${title}</a></h3>
                                <span class="article-meta">By ${author} / ${new Date(publishedAt).toLocaleDateString()}</span>
                                <p class="article-excerpt">${description}</p>
                            </div>
                        </article>
                    `;
                }
            }


            // --- 3. EVENT LISTENERS & NEW FUNCTIONS ---

            function updateSidebarWidgets(category) {
                categoryWidgets.forEach(widget => {
                    widget.style.display = 'none';
                });

                if (category === 'home') {
                    categoryWidgets.forEach(widget => {
                        widget.style.display = 'block';
                    });
                } else {
                    const widgetToShow = document.querySelector(`#widget-${category}`);
                    if (widgetToShow) {
                        widgetToShow.style.display = 'block';
                    }
                }
            }

            async function handleNavClick(e) {
                e.preventDefault(); 
                const link = e.target;
                
                const category = link.dataset.category;
                if (!category) return; 
                
                updateActiveLink(link);
                updateSidebarWidgets(category);

                if (category === 'home') {
                    // 'general' is the best MediaStack query for homepage
                    const articles = await fetchNews('general', 9);
                    renderHomepage(articles);
                } else {
                    const articles = await fetchNews(category, 9);
                    renderCategoryPage(articles, category);
                }
            }
            
            function updateActiveLink(activeLink) {
                navLinks.forEach(link => link.classList.remove('active'));
                activeLink.classList.add('active');
            }

            navLinks.forEach(link => link.addEventListener('click', handleNavClick));

            siteTitle.addEventListener('click', (e) => {
                e.preventDefault();
                const homeLink = document.querySelector('.main-nav a[data-category="home"]');
                if (homeLink) {
                    updateActiveLink(homeLink);
                }
                updateSidebarWidgets('home');
                // 'general' is the best MediaStack query for homepage
                fetchNews('general', 9).then(renderHomepage);
            });

            
            // --- 4. INITIALIZATION ---

            function initializePage() {
                renderSidebar();
                
                // 'general' is the best MediaStack query for homepage
                fetchNews('general', 9).then(renderHomepage);
                
                updateSidebarWidgets('home');
            }

            initializePage();
        });
    </script>
</body>
</html>
